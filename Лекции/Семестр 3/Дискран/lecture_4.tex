% !TEX root = ../../../main.tex
\section{Гамильтоновость графа}
\begin{definition}
    Граф \(G - \)гамильтонов, если \(\exists\) простой цикл, проходящий по всем вершинам графа.
\end{definition}

\begin{theorem}{Дирака}
    Пусть \(G = (V, E), n = |V|, \forall v \in V \ deg \  v \le \frac{n}{2}\). Тогда граф \(G\) гамильтонов.
\end{theorem}

\begin{definition}
    \(\varkappa\) - вершинная связность, то есть минимальное количество вершин, которое нужно удалить из графа, чтобы нарушить его связность:
    \[\varkappa(G) = min \{k : \exists W \subseteq V: |W| = k, G |_{V 
    \setminus W} \text{несвязный}\}\]
\end{definition}

\begin{theorem}{(Эрдеш, Хватал)}
    Пусть \(\varkappa(G) \ge \alpha(G)\). Тогда \(G\) гамильтонов. 
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item Случай, когда в \(G\) нет циклов. Тогда \(G\) --- дерево \(\Ra\) есть хотя бы \(2\) висячих вершины \(\Ra \alpha(G) \ge 2\), но есть и не висячие вершины \(\Ra \kappa(G) \le 1\).
        \item Случай, когда в \(G\) есть циклы. Рассмотрим любой самый длинный простой цикл \(C = \{x_1, x_2, \dots x_k\}, k < n\) (при \(k = n\) граф будет гамильтонов). Тогда удалим \(C\) из \(G\), получим граф \(G'\). Пусть \(W\) --- связная компонента в \(G'\). Положим \(N_W(G) = \{x \in V \setminus W: \exists y \in W: (x, y) \in E\}\).
        \begin{proposition}
            \(N_W(G) \subset C\).
        \end{proposition}
        \begin{proof}
            Это правда, т.к. ребра не могут вести в другие компоненты связности графа \(G'\).
        \end{proof}
        \begin{proposition}
            Если \(x_i = N_W(G) \Ra x_{i + 1} \notin N_W(G)\).
        \end{proposition}
        \begin{proof}
            Пусть \(\exists i: x_i \in N_W(G), x_{i + 1} \in N_W(G)\). Тогда существует цикл большей длины, проходящий через \(x_i\), заходящий в компоненту \(W\) и выходящий через \(x_{i + 1}\).
        \end{proof}
        \begin{corollary}
            \(N_W(G) \subsetneq C\)
        \end{corollary}
        \begin{proposition}
            \(\kappa(G) \le |N_W(G)|\).
        \end{proposition}
        \begin{proof}
            Удалим \(N_W(G)\). Т.к. \(C \setminus N_W(G) \ne \emptyset\), то граф распался на \(\ge 2\) компоненты связности. Но тогда \(\kappa(G) \le |N_W(G)|\).
        \end{proof}
        \begin{proposition}
            Рассмотрим \(M = \{x_{i + 1} | x_i \in N_W(G)\}\). Тогда \(M\) --- независимое множество.
        \end{proposition}
        \begin{proof}
            Заметим, что \(|M| = |N_W(G)|, M \cap N_W(G) = \emptyset\). Предположим, что \(\exists x_{i + 1}, x_{j + 1} \in M: (x_{i + 1}, x_{j + 1}) \in E\). Но т.к. \(x_i, x_j \in N_W(G)\), то существует путь \(x_{i + 1} \ra x_{j + 1} \ra \text{по циклу} \ra x_{i} \ra \text{по \(W\)} \ra x_j \ra \text{обратно по циклу} \ra x_{i + 1}\).
        \end{proof}
        Рассмотрим \(x \in W\). Заметим, что \(M \cup \{x\}\) --- тоже независимое множество. Но тогда \(\alpha(G) \ge |M| + 1 = |N_W(G)| + 1 > \kappa(G)\). Пришли к противоречию.
    \end{enumerate}
\end{proof}

\begin{note}
    В 2 предыдущих теоремах связность графа следует из условия. В теореме Дирака все компоненты связности должны быть \(ge \frac{n}{2} + 1 \Longrightarrow \) их не более 1. А в теореме Эрдеша-Хватала \(\alpha(G) \ge 1 \Longrightarrow \kappa(G) \ge 1\)
\end{note}

\begin{example}
    Рассмотрим граф \(G(n, 3, 1): V = \{A \subset \{1, 2, \dots n\}: |A| = 3\} \Ra |V| = C_n^3, E = \{(A, B): |A \cap B| = 1\}\). Известно, что \(\alpha(G(n, 3, 1)) \le n\).

    Признак дирака на таком графе не работает, т.к. граф разреженный, т.е. \(\deg \text{каждой вершины} = 3C_{n - 3}^2 \sim \frac{3n^2}{2}\).

    Однако, \(\kappa(G) \ge \min_{v, w \in V} f(v, w)\), где \(f\) --- количество общих соседей у \(v, w\). Рассмотрим, какие тройки могут быть аргументами \(f\). Б.О.О, положим первую тройку \(1, 2, 3\), вторую будем подбирать для того, чтобы было \(0, 1, 2\) пересечений с первой тоже не ограничивая общность.
    \[\begin{array}{c|c|c}
        A & B & f(A, B) \\
        \hline
        \{1, 2, 3\} & \{4, 5, 6\} & 9(n - 6) \\ 
        \{1, 2, 3\} & \{3, 4, 5\} & C_{n - 5}^2 + 4(n - 5) \\ 
        \{1, 2, 3\} & \{2, 3, 4\} & 2C_{n - 4}^2 + n - 4 \\ 
    \end{array}\]
    Теперь заметим, что теорема Эрдеша-Хватала доказывает гамильтоновость графа (т.к. \(\kappa(G) \ge n \ge \alpha(G)\)), в то время, как Дирак тут бессилен :(((.
\end{example}

Рассмотрим жадный алгоритм: будем красить вершины последовательно, причем каждую новую вершину будем красить в минимальный возможный цвет (иначе, добавляем новый цвет). Пусть \(\chi_\text{ж}(G)\) --- количество цветов, в которое наш алгоритм покрасил граф, \(\alpha_\text{ж}(G)\) --- максимальное количество вершин одного цвета при покраске жадным алгоритмом. 

\begin{note}
    \(\alpha_\text{ж}(G) \le \alpha(G), \chi_\text{ж}(G) \ge \chi(G)\).
\end{note}

\begin{theorem}
    Тогда \(\forall \epsilon > 0 P\left( \frac{\alpha(G)}{\alpha_\text{ж}(G)} \le 2 + \epsilon \right) \ra 1, n \ra \infty\).
\end{theorem}

Заметим, что жадный алгоритм полиномиальный (работает за \(O(n^2)\)), причем он ошибается всего в 2 раза. Возникает вопрос: можно ли придумать полиномиальный алгоритм лучше, который может ошибаться в меньшее количество раз. Ответ: никто не знает. Кокнуло?