% !TEX root = ../../../main.tex

\section{Методы вычисления кратного интеграла}
\subsection{Сведение кратного интеграла к повторному}

\underline{\textbf{Обозначение:}} \(\mu_n\) --- Мера Лебега в \(\R^n\)

\begin{definition}
    Интерграл по мере \(\mu_n\) называется \(n\)-кратным и обозначается
    \[\int_E fd\mu_n, \int_{E\subset \R^n} f(x)d\mu_n(x), {\int\int\dots\int}_E f(x_1, x_2, \dots x_n) dx_1dx_2\dots dx_n\]
\end{definition}

\underline{\textbf{Обозначение:}} \(x = (x_1, x_2, \dots x_n), y = (y_1, y_2, \dots y_n)\).

\begin{definition}
    Пусть \(E \subset \R^{n + m}, x \in \R^n\). Тогда \(E_x = \{y \in \R^m | (x, y) \in E\}\), \(E_x\) называется сечением \(E\) по переменной \(x\).
\end{definition}

\begin{proposition}
    Пусть \(\{E_i\}_{i \in I}\subset 2^{R^{m + n}}\). Тогда 
    \begin{enumerate}
        \item \(\left(\bigcup_{i \in I} E_i\right)_x = \left(\bigcup_{i \in I} (E_i)_x\right)\)
        \item \((E \setminus F)_x = E_x \setminus F_x\)
        \item \(\left(\bigcap_{i \in I} E_i\right)_x = \left(\bigcap_{i \in I} (E_i)_x\right)\)
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item \(y \in \left(\bigcup_i E_i\right)_x \Lra (x, y) \in \left(\bigcup_i E_i\right) \Lra y \in (\bigcup_i (E_i)_x)\)
        Остальные пункты доказываются аналогично
    \end{enumerate}
\end{proof}

\begin{theorem}[Принцип Кавальери]
    Пусть \(E \in \R^{n + m}\) --- измеримо. Тогда справедливо следующее:
    \begin{enumerate}
        \item Сечение \(E_x\) измеримо в \(\R^m\) для почти всех \(x \in \R^n\).
        \item \(x \mapsto \mu_n(E_x)\) измерима на \(\R^n\)
        \item \(\int_{\R^m}\mu_n(E_x)d\mu_n(x) = \mu_{n + m}(E)\)
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item Пусть \(E\) --- брус. Тогда \(B = B' \times B''\), где \(B', B''\) --- брусы в \(\R^n, \R^m\) соответственно. Для любого \(x \in \R^n\) верно 
        \[B_x = \left\{\begin{array}{ll}
            B'', x \in B' \\
            \emptyset, x \notin B'
        \end{array}\right. \Ra \mu_m(B_x) = \left\{\begin{array}{ll}
            \mu_m(B''), x \in B' \\
            0, x \notin B'
        \end{array}\right.\]
        Функция \(x \mapsto \mu_m(B'') I_{B'}\) --- измерима (как произведение индикатора на константу)

        \[\int_{\R^n} \mu_n(B_x) d\mu(x) = \mu_m(B'')\int_{\R^n}\mu_n(B') = \mu_{n + m}(B)\]

        \item Пусть \(E \subset G\) --- ограниченное открытое множество в \(\R^{n + m}\), тогда \(G = \bigsqcup_{k = 1}^\infty B_k\), где \(B_k\) --- брусья. Для любого \(x \in \R^n\) имеем: \(G_x = \bigsqcup_{k = 1}^\infty (B_k)_x\) --- измеримо, тогда \(\mu_m(G_x) = \sum_{k = 1}^\infty \mu_m((B_k)_x)\). Функция \(\mu_m(G_x)\) измерима, как сумма ряда измеримых функций. По теореме Леви для рядов, 
        \[\int_{\R^n} \mu_m(G_x)d\mu(x) = \sum_{k = 1}^\infty \int_{\R^n}\mu_m((B_k)_x)d\mu(x) = \sum_{k = 1}^\infty \mu_{n + m}(B_k) = \mu(G)\]
        \item Пусть \(E = \bigcap G_k\) --- пересечение вложенных ограниченных открытых множеств (\(G_k \supset G_{k + 1} \forall k\)). Для любого \(x \in \R^n\) имеем \((G_k)_x \supset (G_{k + 1})_x\), \(\mu(G_1)_x < \infty\), тогда \(E_x = \bigcap_{k = 1}^\infty(G_k)_x\) по непрерывности меры. \(\mu_m(E_x) = \lim_{k \ra \infty}\mu_m((G_k)_x)\). Т.к. 
        \[\int_{\R^n} \mu_m((G_1)_x)d\mu(x) = \mu_{n + m}(G_1) < \infty\]
        \[\int_{\R^n}\mu_m(E_x)d\mu(x) = \lim_{k \ra \infty} \int_{\R^n} \mu_m((G_k)_x)d\mu(x) = \lim_{k \ra \infty} \mu_{n + m}(G_k) = \mu_{n + m}(E)\]
        \item Пусть \(E = Z\) --- ограниченное множество меры нуль в \(\R^{n + m}\). По критерию измеримости, существует \(G_\delta\)-множество \(A \supset Z\) и \(\mu_{n + m}(A) = 0\). Можно считать, что \(A\) ограничено (иначе заменим на пересечение с открытым шаром, содержащим \(Z\)). Тогда по предыдущему пункту, \(\int_{\R^n} \mu_m(A_x)d\mu(x) = 0 \Ra \mu_m(A_x) = 0\) для почти всех \(x \in \R^n\). Т.к. \(A_x \supset Z_x\), то \(\mu_m(Z_x) = 0\), и \(Z_x\) измеримо для таких \(x\). Следовательно, функция \(x \mapsto \mu_m(Z_x)\) нулевая почти всюду и тогда она измерима. Также, \[\int_{\R^n} \mu_m(Z_x) d\mu(x) = 0 = \mu_{n + m}(Z)\] 
        \item Пусть \(E\) --- ограниченное измеримое множество. По критерию измеримости, \(\exists \Omega\)--- \(G_\delta\)-множество, \(\Omega \supset E\) и \(Z\) --- множество меры нуль, что \(E = \Omega \setminus Z\) (считаем, что \(\Omega\) ограниченное). По свойству сечений, \(E_x = \Omega_x \setminus Z_x\). Пусть \(E\) --- произвольное измеримое множество. Тогда \(E = \bigsqcup_{k = 1}^\infty (E \cap A_k)\), где \(A_k = \{x \in \R^{n + m}\}, k - 1 \le |x| \le k\)
    \end{enumerate}
\end{proof}

\begin{theorem}[Тонелли]
    Пусть \(E \subset \R^{n + m}\) и функция \(f: E \ra [0, +\infty]\) измерима. Тогда
    \begin{enumerate}
        \item Функция \(f(x, \cdot)\) измерима на \(E_x\) для почти всех \(x \in \R^n\)
        \item Функция \(\mathcal{G}(x) = \int_{E_x}f(x, y)d\mu(y)\) измерима на \(\R^n\)
        \item \(\int_{\R^n}\mathcal{G}(x)d\mu(x) = \int_E f d \mu\)
    \end{enumerate}
\end{theorem}
\begin{proof}
    Пусть \(A \subset \R^{n + m}, x \in \R^n\). Тогда для любого \(y \in \R^m\) верно: \(I_A(x, y) = \left\{\begin{array}{ll}
        1, y \in A_x \\ 
        0, y \notin A_x
    \end{array}\right. = I_{A_x}(y)\), поэтому для индикатора теорема верна (а, значит, и для всех простых функций).
    Пусть \(f: E \ra [0, +\infty]\) --- произвольная измеримая функция. По теореме о приближении, \(\exists \{\phi_k\}\) --- простые функции, т.ч. \(0\le \phi_1 \le \phi_2 \le \dots, \phi_k \ra_E f\). Для любого \(x \in \R^n \exists \{\phi_k(x, \cdot)\}, 0 \le \phi_1(x, \cdot) \le \phi_2(x, \cdot) \le \dots, \phi_k(x, \cdot) \ra_E f(x, \cdot)\). \(\exists Z_k\) --- множество меры нуль в \(\R^n\), что \(\phi_k(x, \cdot)\) измерима (простая функция) на \(Z_k^c\). Положим \(Z = \bigcap_{k = 1}^\infty Z_k\) --- множество меры нуль и для \(x \in \Z^c\) функция измерима (как предел измеримых функций) (доказали 1). По теореме Леви для \(x \in Z^c\) имеем
    \[\mathcal{G}(x) = \lim_{k \ra \infty} \int_{E_x}\phi_k(x, y)d\mu(y) =: \lim_{k \ra \infty} \mathcal{G}_k(x)\]
    Следовательно, \(\mathcal{G}\) измерима (как предел измеримых функций \(\mathcal{G}_k\)) на \(Z^c\), а значит, и на \(\R^n\). Снова по Теореме Леви,
    \[\int_{\R^n}\mathcal{G}_xd\mu(x) = \lim_{k \ra \infty} \int_{\R^n} \mathcal{G}_k(x)d\mu(x) = \lim_{k \ra \infty} \int_E \phi_kd\mu_{n + m} = \int_E f d \mu_{n + m}\]
\end{proof}

\begin{corollary}
    Пусть \(f: E \ra \overline{\R}\) измерима. Функция \(f\) интегрируема на \(E\) тогда и только тогда, когда 
    \[\int_{\R^n}\left(\int_{E_x}|f(x, y)|d\mu(y)\right)d\mu(x) < \infty\]
\end{corollary}

\begin{theorem}[Фубини]
    Пусть \(E \subset \R^{n + m}\) и функция \(f: E \ra \overline{\R^n}\) интегрируема. Тогда
    \begin{enumerate}
        \item Функция \(f(x, \cdot)\) измерима на \(E_x\) для почти всех \(x \in \R^n\)
        \item Функция \(\mathcal{G}(x) = \int_{E_x}f(x, y)d\mu(y)\) интегрируема на \(\R^n\)
        \item \(\int_{\R^n}\mathcal{G}(x)d\mu(x) = \int_E f d \mu\)
    \end{enumerate}
\end{theorem}
\begin{proof}
    Пусть \(f \ge 0\). Тогда по т. Тонелли, \(\int_{\R^n} \mathcal{G}(x)d\mu(x) = \int_E f d \mu < \infty\), следовательно, \(\mathcal{G}\) интегрируема на \(\R^n\) (доказали 2). В частности, функция \(\mathcal{G}\) конечна почти всюду (доказали 1). В случае \(f\) произвольного знака, применяем утверждение для \(f^\pm\):\(f = f^+ - f^-\), пользуясь тем, что \(f^\pm(x, \cdot) = (f(x, \cdot))^\pm\), заключаем, что утверждение верно и для \(f\).
\end{proof}

\begin{note}
    В предыдущих теоремах переменные \(x, y\) равноправны, поэтому 
    \[\int_E f d \mu = \int_{\R^n}\left(\int_{E_x}f(x, y)d\mu(y)\right)d\mu(x) = \int_{\R^n}\left(\int_E f(x, y)d\mu(x)\right)d\mu(y)\]
    Внешний интеграл (в среднем выражении) можно брать не по всему \(\R^n\), а только по тем \(x\), для которых \(E_x \ne \emptyset\)
\end{note}

\begin{definition}
    \(\Pr_xE = \{x \in \R^n | \exists (x, y) \in E\}\) --- проекция \(E\) на \(\R^n_x\)
\end{definition}

\begin{example}
    Проекция измеримого множества может оказаться неизмеримым:
    Рассмотрим \(e \subset \R\) --- неизмеримое. Тогда проекция \(e \times \{c\}, c \in \R\) --- измеримо (его мера равна 0), но его проекция на первую координату равна \(e\) --- неизмеримо.
\end{example}

\begin{corollary}
    Если дополнительно (с условием теорем выше) \(\Pr_x E\) измеримо, то 
    \[\int_E f d \mu_{n + m} = \int_{\Pr_x E} \left(\int_{E_x} f(x, y)d\mu(y)\right)d\mu(x)\]
\end{corollary}

\begin{example}
    Доказать интегрируемость и найти интеграл \(f(x, y) = y\sin x \cdot e^{-xy}\) на \(E = (0, +\infty) \times (0, 1)\)
\end{example}
\begin{proof}
    \[\iint_E |f(x, y)| dxdy \le \iint_E ye^{-yx}dxdy = \int_{(0, 1)}\left(\int_{0, +\infty}ye^{-xy}dx\right)dy =\]
    \[ = \int_{(0, 1)}\left(\int_0^{+\infty} ye^{-yx}dx\right)dy = \int_{(0, 1)}\left(\int_0^{+\infty} e^{-t}dt\right)dy = 1\]
\end{proof}

По теореме Фубини, \(F(y) = \int_0^{+\infty} \sin x e^{-xy}dx \stackrel{\text{после нетрудных преобразований}}{=}\frac{y}{y^2 + 1}, y \in (0, 1)\)
\[\iint_E f(x, y)dxdy = \int_{(0, 1)}\left(\int_{(0, +\infty)} f(x, y)dx\right)dy = \int_0^1 \frac{y}{y^2 + 1}dy = \frac{1}{2} \ln(y^2 + 1)|_0^1 = \frac{1}{2}\ln 2\]
